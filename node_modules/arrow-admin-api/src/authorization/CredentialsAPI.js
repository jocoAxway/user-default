const APIProvider = require('../APIProvider');
const CredentialDetail = require('./schema/CredentialDetail');

class CredentialsAPI extends APIProvider {
	static bind(controller) {
		const swagger = controller.ctx.swagger;

		swagger
			.schema('CredentialDetail', CredentialDetail.schema);

		swagger
			.get('/credentials')
			.operationId('getCredentials')
			.tag('credentials')
			.summary('Gets an array of managed credentials')
			.response(200, 'OK', 'CredentialDetail', true)
			.response(500)
			.action((req, res) => {
				controller.getCredentials()
					.then(credentials => {
						res.status(200).send(credentials);
					})
					.catch(err => {
						APIProvider.handleError(err, res, 500);
					});
			});
	}
}

exports = module.exports = CredentialsAPI;
