{
	"$schema": "http://json-schema.org/draft-06/schema#",
	"id": "http://axway.com/schemas/flow-v3.json",
	"title": "Flow Schema",
	"description": "The schema for a Flow definition.",
	"type": "object",
	"additionalProperties": false,
	"properties": {
		"schemaVersion": {
			"description": "The flow schema version.",
			"type": "string",
			"enum": [
				"1",
				"2",
				"3"
			]
		},
		"info": {
			"description": "Provides detailed information about the flow.",
			"type": "object",
			"properties": {
				"name": {
					"type": "string",
					"description": "The name of the flow. If this isn't specified the filename will be used"
				},
				"description": {
					"type": "string",
					"description": "A description of the flow"
				},
				"author": {
					"type": "string",
					"description": "The flow author"
				},
				"license": {
					"type": "string",
					"description": "The flow license"
				}
			},
			"required": [
				"name"
			]
		},
		"parameter": {
			"$ref": "#/definitions/inputParameters",
			"description": "An object that describes a set of parameter inputs into the flow."
		},
		"start": {
			"description": "The ID of the first node to be executed.",
			"type": "string"
		},
		"nodes": {
			"description": "The instances of nodes used by the flow.",
			"type": "object",
			"additionalProperties": {
				"$ref": "#/definitions/node"
			}
		}
	},
	"required": [
		"schemaVersion",
		"info",
		"nodes",
		"start"
	],
	"definitions": {
		"node": {
			"description": "The node instances.",
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"name": {
					"description": "The display name of the node",
					"type": "string"
				},
				"type": {
					"description": "The node type identifier.",
					"type": "string"
				},
				"method": {
					"type": "string",
					"description": "Node specific method name if the method supports multiple functions."
				},
				"parameters": {
					"$ref": "#/definitions/parameters"
				},
				"outputs": {
					"additionalProperties": {
						"$ref": "#/definitions/output-node"
					}
				}
			},
			"required": [
				"type",
				"name",
				"method",
				"parameters",
				"outputs"
			]
		},
		"output-node": {
			"description": "Detail for handling the output of the flow-node.",
			"type": "object",
			"properties": {
				"context": {
					"oneOf": [
						{
							"type": "string"
						},
						{
							"type": "null"
						}
					]
				},
				"routes": {
					"$ref": "#/definitions/routes"
				}
			},
			"additionalProperties": false
		},
		"routes": {
			"description": "The array of IDs of the node(s) to be executed next. Can be null for terminal nodes.",
			"oneOf": [
				{
					"type": "array",
					"uniqueItems": true,
					"items": {
						"type": "string"
					}
				},
				{
					"type": "string"
				},
				{
					"type": "null"
				}
			]
		},
		"parameters": {
			"description": "The list of input parameters for this node.",
			"type": "array",
			"uniqueItems": true,
			"items": {
				"$ref": "#/definitions/parameter"
			}
		},
		"parameter": {
			"description": "The details of an input parameter.",
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"name": {
					"description": "The name of the parameter.",
					"type": "string"
				},
				"value": {
					"description": "A stringified value representing the specified type.",
					"type": "string"
				},
				"type": {
					"type": "string",
					"description": "The type of `value` (defaults to 'jsonpath').",
					"default": "jsonpath",
					"enum": [
						"jsonpath",
						"boolean",
						"number",
						"string",
						"object",
						"array",
						"null"
					]
				}
			},
			"anyOf": [
				{
					"required": [
						"name",
						"value"
					]
				},
				{
					"required": [
						"name",
						"value",
						"type"
					]
				}
			]
		},
		"inputParameters": {
			"type": "object",
			"description": "An object that describes a set of parameter inputs",
			"properties": {
				"type": {
					"type": "string",
					"enum": [
						"object"
					]
				},
				"properties": {
					"type": "object",
					"additionalProperties": {
						"$ref": "http://json-schema.org/draft-06/schema#"
					}
				},
				"required": {
					"type": "array",
					"uniqueItems": true,
					"items": {
						"type": "string"
					}
				},
				"additionalProperties": {
					"type": "boolean",
					"enum": [
						false
					]
				}
			},
			"required": [
				"properties",
				"additionalProperties"
			],
			"additionalProperties": false
		}
	}
}
