/**
 * @module axway-flow-authorization
 */
const CredentialManager = require('./credentialmanager');

const { handler: AuthorizationNode, spec: AuthorizationNodeSpec } = require('./authorizationNode');

function _registerAuthorizationNodeHandler(flowManager) {
	const uri = flowManager.formatNodeHandlerUri('axway-flow-authorization', 'authz');
	flowManager.registerNode(uri, AuthorizationNode, AuthorizationNodeSpec);
}

function _unregisterAuthorizationNodeHandler(flowManager) {
	const uri = flowManager.formatNodeHandlerUri('axway-flow-authorization', 'authz');
	flowManager.unregisterNode(uri);
}

function register(flowManager) {
	_registerAuthorizationNodeHandler(flowManager);
}

function unregister(flowManager) {
	_unregisterAuthorizationNodeHandler(flowManager);
}

exports = module.exports = {
	/**
	 * The credential manager singleton.
	 * @type axway-flow-authorization.CredentialManager
	 */
	CredentialManager,
	register,
	unregister
};
